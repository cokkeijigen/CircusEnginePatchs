project(DC3WY_CN)

set(SOURCE_DIR "${CMAKE_CURRENT_LIST_DIR}/src")
file(GLOB_RECURSE SOURCES "${SOURCE_DIR}/*.cpp")

add_library(DC3WY_CN SHARED ${SOURCES})

file(GLOB HEADER_DIR ALL_FILES_AND_DIRS 
    "${SOURCE_DIR}"
    "${SOURCE_DIR}/*"
    "${SOURCE_DIR}/*/*"
)
list(FILTER HEADER_DIR EXCLUDE REGEX ".*\\..*")
target_include_directories(DC3WY_CN PUBLIC
    ${HEADER_DIR}
)
target_link_libraries(DC3WY_CN Utillibs)

set_target_properties(DC3WY_CN PROPERTIES
    LINK_FLAGS "/ENTRY:DllMainCRTStartupForYY_Thunks /DYNAMICBASE:NO"
)

add_custom_command(TARGET DC3WY_CN POST_BUILD
    COMMAND ${CMAKE_COMMAND} -E copy "$<TARGET_FILE:DC3WY_CN>" "D:\\Galgame\\DC3WY"
)
